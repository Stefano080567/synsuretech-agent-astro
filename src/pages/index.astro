---
/**
 * DEMO-STABLE (single file)
 * - No imports
 * - No external components
 * - Minimal JS for Next/Back
 * - CSS-only polish (Apple-like)
 */
const DEMO_VERSION = "demo-stable-v1";
const DEMO_TITLE = "WikiSure™ Demo";
const BACK_TO_SITE_URL = "https://synsuretech.org";
---

<!doctype html>
<html lang="de">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>{DEMO_TITLE}</title>
    <meta name="description" content="Guided demo: definitions and decisions for aligned partner execution." />
  </head>

  <body>
    <header class="topbar">
      <a class="backlink" href={BACK_TO_SITE_URL} rel="noopener">
        ← Back to SynsureTech
      </a>
      <div class="badge" aria-label="Version">
        {DEMO_VERSION}
      </div>
    </header>

    <main>
      <section class="card">
        <div class="stepmeta">
          <span class="steplabel" id="stepLabel">Step 1 of 6</span>
        </div>

        <div id="content" class="content" aria-live="polite"></div>

        <div class="actions">
          <button id="btnBack" class="btn secondary" type="button">Back</button>
          <button id="btnNext" class="btn primary" type="button">Next</button>
        </div>
      </section>

      <footer class="footer">
        <span>© SynsureTech</span>
        <span class="dot">•</span>
        <span>Demo only</span>
      </footer>
    </main>

    <script>
      // --- stable, deterministic demo state ---
      const steps = [
        {
          title: "Why WikiSure™ Exists",
          body: `
            <h1>Move faster with clarity.</h1>
            <p>
              In partner ecosystems, execution speed depends on shared understanding.
              WikiSure™ helps teams align on definitions and decisions so delivery becomes
              repeatable and reliable across organisations.
            </p>
            <p>
              This demo shows a simple guided flow: pick a term, compare definitions,
              validate, and capture a clear decision — with a human staying accountable.
            </p>
          `
        },
        {
          title: "Demo Context",
          body: `
            <h2>Demo Context</h2>
            <p><strong>Region:</strong> Germany</p>
            <p><strong>Use case:</strong> Embedded Insurance</p>
            <p><strong>Perspective:</strong> Platform Provider</p>
            <p class="hint">
              Context is intentionally fixed to keep the story crisp.
            </p>
          `
        },
        {
          title: "Choose a Term",
          body: `
            <h2>Choose a term partners may interpret differently</h2>
            <p>Select one example term:</p>

            <div class="chips" role="list">
              <button class="chip" type="button" data-term="Embedded Insurance Consent">Embedded Insurance Consent</button>
              <button class="chip" type="button" data-term="Coverage Start">Coverage Start</button>
              <button class="chip" type="button" data-term="Claims Responsibility">Claims Responsibility</button>
            </div>

            <div class="field">
              <label for="termInput">Or type your own term</label>
              <input id="termInput" type="text" placeholder="e.g., Payment Default Grace Period" />
            </div>

            <p class="hint">
              The selected term will be carried into the next steps.
            </p>
          `
        },
        {
          title: "Definition",
          body: `
            <h2>Compare definitions</h2>
            <p>
              A governed definition must be implementable: two teams should produce the same behaviour from the text.
            </p>

            <div class="grid">
              <div class="box">
                <div class="boxtitle">Current (Baseline)</div>
                <div class="boxbody" id="baselineBox">
                  <p class="muted">Not set yet.</p>
                </div>
              </div>

              <div class="box">
                <div class="boxtitle accent">Proposed (Draft)</div>
                <div class="boxbody" id="draftBox">
                  <p class="muted">Not set yet.</p>
                </div>
              </div>
            </div>

            <div class="field">
              <label for="baselineInput">Baseline text</label>
              <textarea id="baselineInput" rows="4" placeholder="Paste current definition..."></textarea>
            </div>

            <div class="field">
              <label for="draftInput">Draft text</label>
              <textarea id="draftInput" rows="4" placeholder="Write improved definition..."></textarea>
            </div>
          `
        },
        {
          title: "Validation",
          body: `
            <h2>Validation signal</h2>
            <p>Quick check: is the draft clear, implementable, and safe?</p>

            <div class="signals" role="radiogroup" aria-label="Validation signal">
              <label class="radio">
                <input type="radio" name="signal" value="PASS" checked />
                <span><strong>PASS</strong> — clear & implementable</span>
              </label>
              <label class="radio">
                <input type="radio" name="signal" value="REVISE" />
                <span><strong>REVISE</strong> — good direction, needs edits</span>
              </label>
              <label class="radio">
                <input type="radio" name="signal" value="FLAG" />
                <span><strong>FLAG</strong> — needs expert / compliance review</span>
              </label>
            </div>

            <div class="field">
              <label for="noteInput">Short reviewer note</label>
              <textarea id="noteInput" rows="3" placeholder="One sentence why you chose the signal..."></textarea>
            </div>

            <p class="hint">
              The system can assist, but a human owns the decision.
            </p>
          `
        },
        {
          title: "Decision",
          body: `
            <h2>Decision summary</h2>
            <p>
              A governed outcome is more than “yes/no”: it includes signal, rationale, and next action.
            </p>

            <div class="summary">
              <div><span class="k">Term:</span> <span id="sumTerm">—</span></div>
              <div><span class="k">Signal:</span> <span id="sumSignal">—</span></div>
              <div><span class="k">Reviewer note:</span> <span id="sumNote">—</span></div>
            </div>

            <div class="cta">
              <a class="btn primary" href="${BACK_TO_SITE_URL}" rel="noopener">Back to SynsureTech</a>
              <button id="btnRestart" class="btn secondary" type="button">Restart demo</button>
            </div>
          `
        }
      ];

      const state = {
        idx: 0,
        term: "Embedded Insurance Consent",
        baseline: "",
        draft: "",
        signal: "PASS",
        note: ""
      };

      const $content = document.getElementById("content");
      const $stepLabel = document.getElementById("stepLabel");
      const $btnBack = document.getElementById("btnBack");
      const $btnNext = document.getElementById("btnNext");

      function esc(s) {
        return String(s || "")
          .replaceAll("&", "&amp;")
          .replaceAll("<", "&lt;")
          .replaceAll(">", "&gt;")
          .replaceAll('"', "&quot;")
          .replaceAll("'", "&#039;");
      }

      function render() {
        const total = steps.length;
        const step = steps[state.idx];

        $stepLabel.textContent = `Step ${state.idx + 1} of ${total}`;
        $content.innerHTML = step.body;

        // buttons
        $btnBack.disabled = state.idx === 0;
        $btnNext.textContent = state.idx === total - 1 ? "Done" : "Next";

        // wire step-specific UI
        if (state.idx === 2) {
          const termInput = document.getElementById("termInput");
          if (termInput) termInput.value = state.term;

          document.querySelectorAll(".chip").forEach((btn) => {
            btn.addEventListener("click", () => {
              state.term = btn.getAttribute("data-term") || state.term;
              if (termInput) termInput.value = state.term;
            });
          });

          if (termInput) {
            termInput.addEventListener("input", (e) => {
              state.term = e.target.value || state.term;
            });
          }
        }

        if (state.idx === 3) {
          const baselineInput = document.getElementById("baselineInput");
          const draftInput = document.getElementById("draftInput");
          const baselineBox = document.getElementById("baselineBox");
          const draftBox = document.getElementById("draftBox");

          if (baselineInput) baselineInput.value = state.baseline;
          if (draftInput) draftInput.value = state.draft;

          const syncBoxes = () => {
            const b = baselineInput?.value?.trim() || "";
            const d = draftInput?.value?.trim() || "";
            state.baseline = b;
            state.draft = d;

            if (baselineBox) baselineBox.innerHTML = b ? `<p>${esc(b)}</p>` : `<p class="muted">Not set yet.</p>`;
            if (draftBox) draftBox.innerHTML = d ? `<p>${esc(d)}</p>` : `<p class="muted">Not set yet.</p>`;
          };

          baselineInput?.addEventListener("input", syncBoxes);
          draftInput?.addEventListener("input", syncBoxes);
          syncBoxes();
        }

        if (state.idx === 4) {
          document.querySelectorAll('input[name="signal"]').forEach((r) => {
            r.checked = r.value === state.signal;
            r.addEventListener("change", (e) => {
              state.signal = e.target.value;
            });
          });

          const noteInput = document.getElementById("noteInput");
          if (noteInput) noteInput.value = state.note;
          noteInput?.addEventListener("input", (e) => {
            state.note = e.target.value || "";
          });
        }

        if (state.idx === 5) {
          const sumTerm = document.getElementById("sumTerm");
          const sumSignal = document.getElementById("sumSignal");
          const sumNote = document.getElementById("sumNote");

          if (sumTerm) sumTerm.textContent = state.term || "—";
          if (sumSignal) sumSignal.textContent = state.signal || "—";
          if (sumNote) sumNote.textContent = state.note?.trim() ? state.note.trim() : "—";

          const restart = document.getElementById("btnRestart");
          restart?.addEventListener("click", () => {
            state.idx = 0;
            state.baseline = "";
            state.draft = "";
            state.signal = "PASS";
            state.note = "";
            render();
          });
        }
      }

      $btnBack.addEventListener("click", () => {
        if (state.idx > 0) {
          state.idx -= 1;
          render();
        }
      });

      $btnNext.addEventListener("click", () => {
        if (state.idx < steps.length - 1) {
          state.idx += 1;
          render();
        } else {
          // Done -> keep on last step
          state.idx = steps.length - 1;
          render();
        }
      });

      render();
    </script>

    <style>
      :root {
        --synsuretech-blue: #0a3cff;
        --text-primary: #0f172a;
        --text-secondary: #475569;
        --border: rgba(15, 23, 42, 0.10);
        --bg: #ffffff;
      }

      html, body {
        margin: 0;
        padding: 0;
        background: var(--bg);
        color: var(--text-primary);
        font-family:
          -apple-system,
          BlinkMacSystemFont,
          "SF Pro Text",
          "SF Pro Display",
          "Segoe UI",
          Roboto,
          Helvetica,
          Arial,
          system-ui,
          sans-serif;
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
      }

      .topbar {
        position: sticky;
        top: 0;
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 14px 18px;
        background: rgba(255,255,255,0.9);
        backdrop-filter: blur(10px);
        border-bottom: 1px solid var(--border);
      }

      .backlink {
        text-decoration: none;
        color: var(--text-primary);
        font-weight: 500;
      }

      .badge {
        font-size: 12px;
        color: var(--text-secondary);
        border: 1px solid var(--border);
        padding: 6px 10px;
        border-radius: 999px;
      }

      main {
        max-width: 760px;
        margin: 0 auto;
        padding: 36px 18px 70px;
      }

      .card {
        border: 1px solid var(--border);
        border-radius: 18px;
        padding: 22px;
        background: #fff;
      }

      .stepmeta {
        display: flex;
        justify-content: flex-start;
        margin-bottom: 10px;
      }

      .steplabel {
        font-size: 13px;
        color: var(--text-secondary);
      }

      h1, h2 {
        font-weight: 600;
        letter-spacing: -0.015em;
        line-height: 1.2;
        margin: 0 0 14px;
      }

      h1 { font-size: 32px; }
      h2 { font-size: 24px; }

      p {
        font-size: 17px;
        line-height: 1.6;
        color: var(--text-secondary);
        margin: 0 0 16px;
      }

      .hint { font-size: 14px; color: var(--text-secondary); }

      .accent { color: var(--synsuretech-blue); }

      .actions {
        display: flex;
        gap: 12px;
        justify-content: flex-end;
        margin-top: 18px;
      }

      .btn {
        border-radius: 12px;
        padding: 10px 14px;
        border: 1px solid var(--border);
        background: #fff;
        cursor: pointer;
        font-family: inherit;
        font-size: 16px;
        font-weight: 500;
      }

      .btn.primary {
        background: var(--synsuretech-blue);
        color: #fff;
        border-color: rgba(10, 60, 255, 0.25);
      }

      .btn.secondary {
        background: #fff;
        color: var(--text-primary);
      }

      .btn:disabled {
        opacity: 0.45;
        cursor: not-allowed;
      }

      .chips {
        display: flex;
        gap: 10px;
        flex-wrap: wrap;
        margin: 10px 0 16px;
      }

      .chip {
        border-radius: 999px;
        padding: 8px 12px;
        border: 1px solid var(--border);
        background: #fff;
        cursor: pointer;
        font-weight: 500;
      }

      .field {
        display: grid;
        gap: 6px;
        margin: 14px 0;
      }

      label {
        font-size: 13px;
        color: var(--text-secondary);
      }

      input, textarea {
        width: 100%;
        border-radius: 12px;
        border: 1px solid var(--border);
        padding: 10px 12px;
        font-size: 15px;
        font-family: inherit;
        outline: none;
      }

      textarea { resize: vertical; }

      .grid {
        display: grid;
        grid-template-columns: 1fr;
        gap: 14px;
        margin: 14px 0;
      }

      @media (min-width: 720px) {
        .grid { grid-template-columns: 1fr 1fr; }
      }

      .box {
        border: 1px solid var(--border);
        border-radius: 14px;
        overflow: hidden;
        background: #fff;
      }

      .boxtitle {
        padding: 10px 12px;
        font-size: 13px;
        color: var(--text-secondary);
        border-bottom: 1px solid var(--border);
      }

      .boxbody {
        padding: 12px;
      }

      .muted {
        color: var(--text-secondary);
        font-size: 14px;
      }

      .signals {
        display: grid;
        gap: 10px;
        margin: 12px 0;
      }

      .radio {
        display: flex;
        gap: 10px;
        align-items: flex-start;
        border: 1px solid var(--border);
        padding: 10px 12px;
        border-radius: 14px;
      }

      .summary {
        border: 1px solid var(--border);
        border-radius: 14px;
        padding: 12px;
        display: grid;
        gap: 10px;
        margin: 14px 0 8px;
      }

      .k {
        color: var(--text-secondary);
        font-size: 13px;
        display: inline-block;
        min-width: 110px;
      }

      .cta {
        display: flex;
        gap: 12px;
        flex-wrap: wrap;
        justify-content: flex-end;
        margin-top: 12px;
      }

      .footer {
        display: flex;
        justify-content: center;
        gap: 10px;
        margin-top: 18px;
        color: var(--text-secondary);
        font-size: 12px;
      }

      .dot { opacity: 0.6; }
    </style>
  </body>
</html>
